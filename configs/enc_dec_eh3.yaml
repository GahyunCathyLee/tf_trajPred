# =========================
# DATA
# =========================
data:
  # exid | highd | combined
  mode: combined

  # window setting
  T: 2
  Tf: 5
  hz: 3

  batch_size: 128
  num_workers: 32

  roots:
    exid_root: data/exiD
    highd_root: data/highD
    exid_pt_root: data/exiD/data_pt
    highd_pt_root: data/highD/data_pt
    combined_root: data/combined

  # scenario labels (optional)
  scenario_labels:
    exid: data/exiD/data_pt/exid_T2_Tf5_hz3/window_labels.csv
    highd: data/highD/data_pt/highd_T2_Tf5_hz3/window_labels.csv

  scenario_sampling:
    mode: event        # event | state
    alpha: 0.5         # 1.0 strong, 0.5 mild
    unknown_weight: 0.0
    clip_max: null


# =========================
# FEATURES
# =========================
features:
  use_ego_static: true
  use_nb_static: true


# =========================
# MODEL
# =========================
model:
  name: enc_dec

  T: 6
  Tf: 15
  K: 8

  ego_dim: 28               # 18 + ego_static(10)
  nb_dim: 16                # 6  + nb_static(10)

  use_neighbors: true

  d_model: 128
  nhead: 4
  enc_layers: 3
  dec_layers: 3
  dropout: 0.1

  predict_delta: false
  M: 6
  return_scores: true


# =========================
# TRAIN
# =========================
train:
  device: cuda
  seed: 42

  epochs: 100
  lr: 3e-4
  weight_decay: 0.01

  use_amp: true
  grad_clip_norm: 1.0

  # loss weights
  w_traj: 1.0
  w_fde: 0.0
  w_cls: 1.0

  # scheduler
  lr_schedule: none      # none | cosine
  warmup_steps: 0

  # stats
  stats_split: train

  # logging / ckpt
  monitor: val_ade        # val_loss | val_ade
  ckpt_dir: ckpts/combined_T2_Tf5_hz3/run_007

  stratified_eval: false
